{
    "$schema": "https://raw.githubusercontent.com/F5Networks/f5-appsvcs-extension/main/schema/latest/as3-schema.json",
    "class": "AS3",
    "action": "deploy",
    "persist": true,
    "declaration": {
        "class": "ADC",
        "schemaVersion": "3.0.0",
        "waf_testing": {
            "class":"Tenant",
            "responder_service": {
                "class": "Application",
                "service_http_200": {
                    "class": "Service_HTTP",
                    "virtualPort": 80,
                    "virtualAddresses": [
                        "1.1.1.1"
                    ],
                    "iRules": [{
                        "use": "rule_http_200"
                    }]
                },
                "rule_http_200": {
                    "class": "iRule",
                    "iRule": {
                        "base64": "d2hlbiBIVFRQX1JFUVVFU1QgewogICAgIyBDYXB0dXJlIHRoZSBmdWxsIFVSSQogICAgc2V0IHVyaSBbSFRUUDo6dXJpXQogICAgc2V0IGhvc3QgW0hUVFA6Omhvc3RdCiAgICBzZXQgcGF0aCBbSFRUUDo6cGF0aF0KICAgIHNldCBxdWVyeSBbSFRUUDo6cXVlcnldCiAgICAKICAgICMgQ2hlY2sgaWYgY2xpZW50IGlzIGN1cmwgb3Igc2ltaWxhciBDTEkgdG9vbAogICAgc2V0IHVzZXJfYWdlbnQgW0hUVFA6OmhlYWRlciAiVXNlci1BZ2VudCJdCiAgICBzZXQgaXNfY2xpIDAKICAgIGlmIHsgW2V4cHIge1tzdHJpbmcgbWF0Y2ggLW5vY2FzZSAiKmN1cmwqIiAkdXNlcl9hZ2VudF0gfHwgW3N0cmluZyBtYXRjaCAtbm9jYXNlICIqd2dldCoiICR1c2VyX2FnZW50XSB8fCBbc3RyaW5nIG1hdGNoIC1ub2Nhc2UgIipodHRwaWUqIiAkdXNlcl9hZ2VudF19XSB9IHsKICAgICAgICBzZXQgaXNfY2xpIDEKICAgIH0KICAgIAogICAgaWYgeyAkaXNfY2xpIH0gewogICAgICAgICMgQnVpbGQgdGV4dC1iYXNlZCByZXNwb25zZSBmb3IgQ0xJIGNsaWVudHMKICAgICAgICBzZXQgb3V0cHV0ICI9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiIKICAgICAgICBhcHBlbmQgb3V0cHV0ICIgICAgICAgICAgICAgICBIVFRQIFJFUVVFU1QgSU5GT1JNQVRJT04gICAgICAgICAgICAgICAgICAgIFxuIgogICAgICAgIGFwcGVuZCBvdXRwdXQgIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4iCiAgICAgICAgCiAgICAgICAgYXBwZW5kIG91dHB1dCAiRlVMTCBVUkxcbiIKICAgICAgICBhcHBlbmQgb3V0cHV0ICItLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiIKICAgICAgICBhcHBlbmQgb3V0cHV0ICIgIGh0dHA6Ly8kaG9zdCR1cmlcblxuIgogICAgICAgIAogICAgICAgIGFwcGVuZCBvdXRwdXQgIlVSTCBDT01QT05FTlRTXG4iCiAgICAgICAgYXBwZW5kIG91dHB1dCAiLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4iCiAgICAgICAgYXBwZW5kIG91dHB1dCAiICBIb3N0OiAgICAgICAgICRob3N0XG4iCiAgICAgICAgYXBwZW5kIG91dHB1dCAiICBQYXRoOiAgICAgICAgICRwYXRoXG4iCiAgICAgICAgYXBwZW5kIG91dHB1dCAiICBRdWVyeSBTdHJpbmc6ICRxdWVyeVxuXG4iCiAgICAgICAgCiAgICAgICAgYXBwZW5kIG91dHB1dCAiUVVFUlkgUEFSQU1FVEVSU1xuIgogICAgICAgIGFwcGVuZCBvdXRwdXQgIi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuIgogICAgICAgIGlmIHsgJHF1ZXJ5IG5lICIiIH0gewogICAgICAgICAgICBmb3JlYWNoIHBhcmFtIFtzcGxpdCAkcXVlcnkgIiYiXSB7CiAgICAgICAgICAgICAgICBzZXQgcGFyYW1fcGFydHMgW3NwbGl0ICRwYXJhbSAiPSJdCiAgICAgICAgICAgICAgICBzZXQgcGFyYW1fbmFtZSBbbGluZGV4ICRwYXJhbV9wYXJ0cyAwXQogICAgICAgICAgICAgICAgc2V0IHBhcmFtX3ZhbHVlIFtsaW5kZXggJHBhcmFtX3BhcnRzIDFdCiAgICAgICAgICAgICAgICBzZXQgcGFyYW1fdmFsdWUgW1VSSTo6ZGVjb2RlICRwYXJhbV92YWx1ZV0KICAgICAgICAgICAgICAgIGFwcGVuZCBvdXRwdXQgIiAgW2Zvcm1hdCAiJS0yMHMiICRwYXJhbV9uYW1lXSA9ICRwYXJhbV92YWx1ZVxuIgogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgYXBwZW5kIG91dHB1dCAiICAoTm8gcXVlcnkgcGFyYW1ldGVycylcbiIKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgYXBwZW5kIG91dHB1dCAiXG5DT09LSUVTXG4iCiAgICAgICAgYXBwZW5kIG91dHB1dCAiLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4iCiAgICAgICAgc2V0IGNvb2tpZV9oZWFkZXIgW0hUVFA6OmNvb2tpZSBuYW1lc10KICAgICAgICBpZiB7IFtsbGVuZ3RoICRjb29raWVfaGVhZGVyXSA+IDAgfSB7CiAgICAgICAgICAgIGZvcmVhY2ggY29va2llX25hbWUgJGNvb2tpZV9oZWFkZXIgewogICAgICAgICAgICAgICAgc2V0IGNvb2tpZV92YWx1ZSBbSFRUUDo6Y29va2llIHZhbHVlICRjb29raWVfbmFtZV0KICAgICAgICAgICAgICAgIGFwcGVuZCBvdXRwdXQgIiAgW2Zvcm1hdCAiJS0yMHMiICRjb29raWVfbmFtZV0gPSAkY29va2llX3ZhbHVlXG4iCiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBhcHBlbmQgb3V0cHV0ICIgIChObyBjb29raWVzKVxuIgogICAgICAgIH0KICAgICAgICAKICAgICAgICBhcHBlbmQgb3V0cHV0ICJcbj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuIgogICAgICAgIAogICAgICAgIEhUVFA6OnJlc3BvbmQgMjAwIGNvbnRlbnQgJG91dHB1dCAiQ29udGVudC1UeXBlIiAidGV4dC9wbGFpbjsgY2hhcnNldD11dGYtOCIKICAgICAgICAKICAgIH0gZWxzZSB7CiAgICAgICAgIyBQYXJzZSBxdWVyeSBwYXJhbWV0ZXJzIGZvciBIVE1MCiAgICAgICAgc2V0IHF1ZXJ5X3BhcmFtcyAiIgogICAgICAgIGlmIHsgJHF1ZXJ5IG5lICIiIH0gewogICAgICAgICAgICBmb3JlYWNoIHBhcmFtIFtzcGxpdCAkcXVlcnkgIiYiXSB7CiAgICAgICAgICAgICAgICBzZXQgcGFyYW1fcGFydHMgW3NwbGl0ICRwYXJhbSAiPSJdCiAgICAgICAgICAgICAgICBzZXQgcGFyYW1fbmFtZSBbbGluZGV4ICRwYXJhbV9wYXJ0cyAwXQogICAgICAgICAgICAgICAgc2V0IHBhcmFtX3ZhbHVlIFtsaW5kZXggJHBhcmFtX3BhcnRzIDFdCiAgICAgICAgICAgICAgICBzZXQgcGFyYW1fdmFsdWUgW1VSSTo6ZGVjb2RlICRwYXJhbV92YWx1ZV0KICAgICAgICAgICAgICAgIGFwcGVuZCBxdWVyeV9wYXJhbXMgIjx0cj48dGQgc3R5bGU9J3BhZGRpbmc6IDhweDsgYm9yZGVyOiAxcHggc29saWQgI2RkZDsnPiRwYXJhbV9uYW1lPC90ZD48dGQgc3R5bGU9J3BhZGRpbmc6IDhweDsgYm9yZGVyOiAxcHggc29saWQgI2RkZDsnPiRwYXJhbV92YWx1ZTwvdGQ+PC90cj4iCiAgICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzZXQgcXVlcnlfcGFyYW1zICI8dHI+PHRkIGNvbHNwYW49JzInIHN0eWxlPSdwYWRkaW5nOiA4cHg7IGJvcmRlcjogMXB4IHNvbGlkICNkZGQ7IHRleHQtYWxpZ246IGNlbnRlcjsgY29sb3I6ICM5OTk7Jz5ObyBxdWVyeSBwYXJhbWV0ZXJzPC90ZD48L3RyPiIKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgIyBQYXJzZSBjb29raWVzIGZvciBIVE1MCiAgICAgICAgc2V0IGNvb2tpZV9oZWFkZXIgW0hUVFA6OmNvb2tpZSBuYW1lc10KICAgICAgICBzZXQgY29va2llcyAiIgogICAgICAgIGlmIHsgW2xsZW5ndGggJGNvb2tpZV9oZWFkZXJdID4gMCB9IHsKICAgICAgICAgICAgZm9yZWFjaCBjb29raWVfbmFtZSAkY29va2llX2hlYWRlciB7CiAgICAgICAgICAgICAgICBzZXQgY29va2llX3ZhbHVlIFtIVFRQOjpjb29raWUgdmFsdWUgJGNvb2tpZV9uYW1lXQogICAgICAgICAgICAgICAgYXBwZW5kIGNvb2tpZXMgIjx0cj48dGQgc3R5bGU9J3BhZGRpbmc6IDhweDsgYm9yZGVyOiAxcHggc29saWQgI2RkZDsnPiRjb29raWVfbmFtZTwvdGQ+PHRkIHN0eWxlPSdwYWRkaW5nOiA4cHg7IGJvcmRlcjogMXB4IHNvbGlkICNkZGQ7Jz4kY29va2llX3ZhbHVlPC90ZD48L3RyPiIKICAgICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHNldCBjb29raWVzICI8dHI+PHRkIGNvbHNwYW49JzInIHN0eWxlPSdwYWRkaW5nOiA4cHg7IGJvcmRlcjogMXB4IHNvbGlkICNkZGQ7IHRleHQtYWxpZ246IGNlbnRlcjsgY29sb3I6ICM5OTk7Jz5ObyBjb29raWVzPC90ZD48L3RyPiIKICAgICAgICB9CiAgICAgICAgCiAgICAgICAgIyBCdWlsZCBIVE1MIHJlc3BvbnNlIGZvciBicm93c2VycwogICAgICAgIHNldCBodG1sICI8IURPQ1RZUEUgaHRtbD4KPGh0bWw+CjxoZWFkPgogICAgPHRpdGxlPlJlcXVlc3QgSW5mb3JtYXRpb248L3RpdGxlPgogICAgPHN0eWxlPgogICAgICAgIGJvZHkgeyBmb250LWZhbWlseTogQXJpYWwsIHNhbnMtc2VyaWY7IG1hcmdpbjogNDBweDsgYmFja2dyb3VuZC1jb2xvcjogI2Y1ZjVmNTsgfQogICAgICAgIGgxIHsgY29sb3I6ICMzMzM7IH0KICAgICAgICBoMiB7IGNvbG9yOiAjNjY2OyBtYXJnaW4tdG9wOiAzMHB4OyB9CiAgICAgICAgdGFibGUgeyBib3JkZXItY29sbGFwc2U6IGNvbGxhcHNlOyB3aWR0aDogMTAwJTsgYmFja2dyb3VuZC1jb2xvcjogd2hpdGU7IG1hcmdpbi1ib3R0b206IDIwcHg7IGJveC1zaGFkb3c6IDAgMnB4IDRweCByZ2JhKDAsMCwwLDAuMSk7IH0KICAgICAgICB0aCB7IGJhY2tncm91bmQtY29sb3I6ICNFMzBGMzcgY29sb3I6IHdoaXRlOyBwYWRkaW5nOiAxMnB4OyB0ZXh0LWFsaWduOiBsZWZ0OyBib3JkZXI6IDFweCBzb2xpZCAjZGRkOyB9CiAgICAgICAgdGQgeyBwYWRkaW5nOiA4cHg7IGJvcmRlcjogMXB4IHNvbGlkICNkZGQ7IH0KICAgICAgICB0cjpudGgtY2hpbGQoZXZlbikgeyBiYWNrZ3JvdW5kLWNvbG9yOiAjZjlmOWY5OyB9CiAgICAgICAgLmluZm8tYm94IHsgYmFja2dyb3VuZC1jb2xvcjogd2hpdGU7IHBhZGRpbmc6IDE1cHg7IG1hcmdpbi1ib3R0b206IDIwcHg7IGJvcmRlci1yYWRpdXM6IDVweDsgYm94LXNoYWRvdzogMCAycHggNHB4IHJnYmEoMCwwLDAsMC4xKTsgfQogICAgPC9zdHlsZT4KPC9oZWFkPgo8Ym9keT4KICAgIDxoMT5IVFRQIFJlcXVlc3QgSW5mb3JtYXRpb248L2gxPgogICAgCiAgICA8ZGl2IGNsYXNzPSdpbmZvLWJveCc+CiAgICAgICAgPHN0cm9uZz5GdWxsIFVSTDo8L3N0cm9uZz4gaHR0cDovLyRob3N0JHVyaQogICAgPC9kaXY+CiAgICAKICAgIDxoMj5VUkwgQ29tcG9uZW50czwvaDI+CiAgICA8dGFibGU+CiAgICAgICAgPHRyPjx0aD5Db21wb25lbnQ8L3RoPjx0aD5WYWx1ZTwvdGg+PC90cj4KICAgICAgICA8dHI+PHRkIHN0eWxlPSdwYWRkaW5nOiA4cHg7IGJvcmRlcjogMXB4IHNvbGlkICNkZGQ7Jz5Ib3N0PC90ZD48dGQgc3R5bGU9J3BhZGRpbmc6IDhweDsgYm9yZGVyOiAxcHggc29saWQgI2RkZDsnPiRob3N0PC90ZD48L3RyPgogICAgICAgIDx0cj48dGQgc3R5bGU9J3BhZGRpbmc6IDhweDsgYm9yZGVyOiAxcHggc29saWQgI2RkZDsnPlBhdGg8L3RkPjx0ZCBzdHlsZT0ncGFkZGluZzogOHB4OyBib3JkZXI6IDFweCBzb2xpZCAjZGRkOyc+JHBhdGg8L3RkPjwvdHI+CiAgICAgICAgPHRyPjx0ZCBzdHlsZT0ncGFkZGluZzogOHB4OyBib3JkZXI6IDFweCBzb2xpZCAjZGRkOyc+UXVlcnkgU3RyaW5nPC90ZD48dGQgc3R5bGU9J3BhZGRpbmc6IDhweDsgYm9yZGVyOiAxcHggc29saWQgI2RkZDsnPiRxdWVyeTwvdGQ+PC90cj4KICAgIDwvdGFibGU+CiAgICAKICAgIDxoMj5RdWVyeSBQYXJhbWV0ZXJzPC9oMj4KICAgIDx0YWJsZT4KICAgICAgICA8dHI+PHRoPlBhcmFtZXRlcjwvdGg+PHRoPlZhbHVlPC90aD48L3RyPgogICAgICAgICRxdWVyeV9wYXJhbXMKICAgIDwvdGFibGU+CiAgICAKICAgIDxoMj5Db29raWVzPC9oMj4KICAgIDx0YWJsZT4KICAgICAgICA8dHI+PHRoPkNvb2tpZSBOYW1lPC90aD48dGg+Q29va2llIFZhbHVlPC90aD48L3RyPgogICAgICAgICRjb29raWVzCiAgICA8L3RhYmxlPgo8L2JvZHk+CjwvaHRtbD4iCiAgICAgICAgCiAgICAgICAgSFRUUDo6cmVzcG9uZCAyMDAgY29udGVudCAkaHRtbCAiQ29udGVudC1UeXBlIiAidGV4dC9odG1sIgogICAgfQp9"
                    }
                }
            },
            "forwarding_service": {
                "class": "Application",
                "service_http": {
                    "class": "Service_HTTP",
                    "virtualPort": 80,
                    "virtualAddresses": [
                        "192.168.57.81"
                    ],
                    "iRules": [{
                        "use": "rule_vs_forward"
                    }]
                },
                "rule_vs_forward" : {
                    "class": "iRule",
                    "iRule": {
                        "base64": "d2hlbiBIVFRQX1JFUVVFU1QgewogIHZpcnR1YWwgL3dhZl90ZXN0aW5nL3Jlc3BvbmRlcl9zZXJ2aWNlL3NlcnZpY2VfaHR0cF8yMDAKfQ=="
                    }
                }
            }
        }
    }
}