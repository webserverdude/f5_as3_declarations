{
    "$schema": "https://raw.githubusercontent.com/F5Networks/f5-appsvcs-extension/main/schema/latest/as3-schema.json",
    "class": "AS3",
    "action": "deploy",
    "persist": true,
    "declaration": {
        "class": "ADC",
        "schemaVersion": "3.0.0",
        "remark": "Demo Tenant for Threat Campaigns",
        "demo_TC": {
            "class":"Tenant",
            "demo_TC": {
                "class": "Application",
                "service_http_200": {
                    "class": "Service_HTTP",
                    "virtualPort": 80,
                    "virtualAddresses": [
                        "1.1.1.2"
                    ],
                    "iRules": [{
                        "use": "rule_http_200"
                    }]
                },
                "rule_http_200": {
                    "class": "iRule",
                    "iRule": {
                        "base64": "d2hlbiBIVFRQX1JFUVVFU1QgewogICBIVFRQOjpyZXNwb25kIDIwMCBjb250ZW50IHsKICAgICAgPGh0bWw+CiAgICAgICAgIDxoZWFkPgogICAgICAgICAgICA8dGl0bGU+QklHLUlQPC90aXRsZT4KICAgICAgICAgPC9oZWFkPgogICAgICAgICA8Ym9keT4KICAgICAgICAgICAgMjAwIE9LCiAgICAgICAgIDwvYm9keT4KICAgICAgPC9odG1sPgogICB9Cn0="
                    }
                },
                "service_https": {
                    "class": "Service_HTTPS",
                    "virtualPort": 443,
                    "virtualAddresses": [
                        "192.168.57.65"
                    ],
                    "redirect80": false,
                    "serverTLS": "frontendtls",
                    "iRules": [{
                        "use": "rule_vs_forward"
                }]
                },
                "rule_vs_forward" : {
                    "class": "iRule",
                    "iRule": {
                        "base64": "d2hlbiBIVFRQX1JFUVVFU1QgewogIHZpcnR1YWwgL2RlbW9fVEMvZGVtb19UQy9zZXJ2aWNlX2h0dHBfMjAwCn0="
                    }
                },
                "frontendtls": {
                    "class": "TLS_Server",
                    "certificates": [{
                        "certificate": "defaultCert"
                    }],
                    "tls1_3Enabled": true,
                    "cipherGroup": {
                        "use": "cg_tls13_tls12"
                    }
                },
                "defaultCert": { 
                    "class": "Certificate",
                    "certificate": {"bigip":"/Common/default.crt"},
                    "privateKey": {"bigip":"/Common/default.key"}
                },
                "cr_tls13_tls12_EC": {
                    "class": "Cipher_Rule",
                    "cipherSuites": [
                        "TLSv1_3:ECDHE-ECDSA-AES256-GCM-SHA384:!DTLSv1_2"
                    ]
                },
                "cr_tls13_tls12_RSA": {
                    "class": "Cipher_Rule",
                    "cipherSuites": [
                        "TLSv1_3:ECDHE-RSA-AES256-GCM-SHA384:!DTLSv1_2"
                    ]
                },
                "cg_tls13_tls12": {
                    "class": "Cipher_Group",
                    "allowCipherRules": [
                        {
                            "use": "cr_tls13_tls12_EC"
                        },
                        {
                            "use": "cr_tls13_tls12_RSA"
                        }
                    ]
                }
            }
        }
    }
}